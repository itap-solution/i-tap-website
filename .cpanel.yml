---
deployment:
  tasks:
    - export DEPLOY_PATH=$HOME/i-tap-website
    - echo "========================================="
    - echo "ğŸš€ Starting Deployment Process..."
    - echo "========================================="
    - echo ""
    
    # Step 1: Install Composer Dependencies (Production only)
    - echo "ğŸ“¦ Step 1: Installing Composer dependencies (production)..."
    - /usr/local/bin/php /usr/local/bin/composer install --no-dev --no-interaction --optimize-autoloader
    - echo "âœ… Composer dependencies installed successfully"
    - echo ""
    
    # Step 2: Install NPM Dependencies
    - echo "ğŸ“¦ Step 2: Installing NPM dependencies..."
    - npm install --production=false
    - echo "âœ… NPM dependencies installed successfully"
    - echo ""
    
    # Step 3: Build Vue Project
    - echo "ğŸ”¨ Step 3: Building Vue project..."
    - npm run build
    - echo "âœ… Vue project built successfully"
    - echo ""
    
    # Step 4: Laravel Cache Operations
    - echo "âš¡ Step 4: Caching Laravel configuration..."
    - /usr/local/bin/php artisan config:cache
    - echo "âœ… Config cache created"
    - /usr/local/bin/php artisan route:cache
    - echo "âœ… Route cache created"
    - /usr/local/bin/php artisan view:cache
    - echo "âœ… View cache created"
    - echo ""
    
    # Step 5: Set proper permissions (if needed)
    - echo "ğŸ” Step 5: Setting storage permissions..."
    - chmod -R 775 storage bootstrap/cache || true
    - echo "âœ… Permissions set"
    - echo ""
    
    # Final message
    - echo "========================================="
    - echo "âœ… Deployment completed successfully!"
    - echo "========================================="
    - echo ""


